"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([["8946"],{39432:function(e,a,l){l.d(a,{Au:()=>m,Fj:()=>s,LC:()=>n,OV:()=>r,dj:()=>u,gK:()=>d,i7:()=>o,v1:()=>p,yW:()=>c});var t=l(34541);let{t:i}=l(76882).Z.global,o=e=>t.e.get("/domains/list",{params:e}),n=()=>t.e.get("/domains/all"),s=e=>t.e.post("/domains/create",e,{fetchOptions:{loading:i("domain.api.loading.creating"),successMessage:!0}}),d=e=>t.e.post("/domains/update",e,{fetchOptions:{loading:i("domain.api.loading.updating"),successMessage:!0}}),u=e=>t.e.post("/domains/delete",e,{fetchOptions:{loading:i("domain.api.loading.deleting"),successMessage:!0}}),r=e=>t.e.post("/domains/set_ssl",e,{fetchOptions:{loading:i("domain.api.loading.settingSSL"),successMessage:!0}}),m=e=>t.e.get("/domains/get_ssl",{params:e}),p=e=>t.e.post("/domains/fresh_dns_records",e,{fetchOptions:{loading:i("domain.api.loading.refreshingDns"),successMessage:!0}}),c=e=>t.e.post("/ssl/apply_cert",e,{fetchOptions:{loading:i("domain.api.loading.applyingCert"),successMessage:!0}})},67127:function(e,a,l){l.d(a,{EV:()=>s,Ts:()=>n,WS:()=>d,iC:()=>o});var t=l(34541);let{t:i}=l(76882).Z.global,o=e=>t.e.get("/mailbox/list",{params:e}),n=e=>t.e.post("/mailbox/create",e,{fetchOptions:{loading:i("mailbox.api.loading.creating"),successMessage:!0}}),s=e=>t.e.post("/mailbox/update",e,{fetchOptions:{loading:i("mailbox.api.loading.updating"),successMessage:!0}}),d=e=>t.e.post("/mailbox/delete",e,{fetchOptions:{loading:i("mailbox.api.loading.deleting"),successMessage:!0}})},77984:function(e,a,l){l.d(a,{F:()=>n});var t=l(68271),i=l(94821),o=l(76882);let n=()=>{let{t:e}=o.Z.global,{copy:a,isSupported:l}=(0,i.VPI)({legacy:!0});return{copyText:async i=>{if(!i)return void t.v0.error(e("common.useCopy.noText"));l.value?(await a(i),t.v0.success(e("common.useCopy.success"))):t.v0.error(e("common.useCopy.failed"))}}}},86559:function(e,a,l){l.d(a,{Z:()=>o});var t=l(73084),i=l(58786);let o=(0,i.aZ)({__name:"index",props:(0,i.Vf)({width:{default:240},prefix:{type:Boolean,default:!1}},{value:{default:""},valueModifiers:{}}),emits:(0,i.Vf)(["search"],["update:value"]),setup(e,a){let{expose:l,emit:o}=a,n=(0,i.iH)(null),s=(0,i.tT)(e,"value"),d=()=>{o("search",s.value)};return l({focus:()=>{var e;null==(e=n.value)||e.focus()}}),(e,a)=>{let l=t.Z;return(0,i.wg)(),(0,i.j4)(l,(0,i.dG)({ref_key:"inputRef",ref:n,value:s.value,"onUpdate:value":a[0]||(a[0]=e=>s.value=e)},e.$attrs,{class:"bt-search",style:{width:`${e.width}px`},onKeyup:(0,i.D2)(d,["enter"])}),(0,i.Nv)({_:2},[e.prefix?{name:"prefix",fn:(0,i.w5)(()=>[(0,i._)("div",{class:"flex items-center cursor-pointer",onClick:d},a[1]||(a[1]=[(0,i._)("i",{class:"i-mdi-search text-16px"},null,-1)]))]),key:"0"}:void 0,e.prefix?void 0:{name:"suffix",fn:(0,i.w5)(()=>[(0,i._)("div",{class:"flex items-center cursor-pointer",onClick:d},a[2]||(a[2]=[(0,i._)("i",{class:"i-mdi-search text-16px"},null,-1)]))]),key:"1"}]),1040,["value","style"])}}})},46244:function(e,a,l){l.d(a,{Z:()=>o});var t=l(98048),i=l(58786);let o=(0,i.aZ)({__name:"index",props:{model:{},rules:{},labelWidth:{},labelPlacement:{default:"top"}},setup(e,a){let{expose:l}=a,o=(0,i.iH)(null);return l({validate:()=>{var e;return null==(e=o.value)?void 0:e.validate()},restoreValidation:()=>{var e;return null==(e=o.value)?void 0:e.restoreValidation()}}),(e,a)=>{let l=t.Z;return(0,i.wg)(),(0,i.j4)(l,(0,i.dG)(e.$attrs,{ref_key:"formRef",ref:o,model:e.model,rules:e.rules,"label-width":e.labelWidth,"label-placement":e.labelPlacement}),{default:(0,i.w5)(()=>[(0,i.WI)(e.$slots,"default")]),_:3},16,["model","rules","label-width","label-placement"])}}})},17743:function(e,a,l){l.r(a),l.d(a,{default:()=>V});var t=l(39244),i=l(25170),o=l(75754),n=l(66760),s=l(86559),d=l(58786),u=l(67655),r=l(29875),m=l(93953),p=l(94821),c=l(68271),f=l(51169),v=l(77984),g=l(67512),h=l(67127),w=l(35409);let x={class:"flex"},b={class:"w-0 flex-1 flex items-center"},_={class:"min-w-0"},U=(0,d.aZ)({__name:"index",props:{value:{default:""}},setup(e){let{copyText:a}=(0,v.F)(),l=(0,d.iH)(!1),t=(0,d.Fl)(()=>l.value?e.value:"**********"),i=()=>{l.value=!l.value},o=async()=>{a(`${e.value}`)};return(e,a)=>{let n=w.ZP;return(0,d.wg)(),(0,d.iD)("div",x,[(0,d._)("div",b,[(0,d._)("div",_,[(0,d.Wm)(n,{class:"max-w-full",tooltip:{contentStyle:{maxWidth:"200px"}}},{default:(0,d.w5)(()=>[(0,d.Uk)((0,d.zw)((0,d.SU)(t)),1)]),_:1})]),(0,d._)("div",{class:"ml-6px text-15px cursor-pointer",title:"Show",onClick:i},[(0,d._)("i",{class:(0,d.C_)((0,d.SU)(l)?"i-mdi-eye-outline":"i-mdi-eye-off-outline")},null,2)]),(0,d._)("div",{class:"reset ml-6px text-15px cursor-pointer text-#333",title:"Copy",onClick:o},a[0]||(a[0]=[(0,d._)("i",{class:"i-mdi-content-copy"},null,-1)]))])])}}});var S=l(8490),y=l(39432),W=l(52495);let Z=(0,d.aZ)({__name:"DomainSelect",props:(0,d.Vf)({isAll:{type:Boolean,default:!0}},{value:{default:()=>null},valueModifiers:{}}),emits:["update:value"],setup(e){let{t:a}=(0,W.QT)(),l=(0,d.tT)(e,"value"),t=(0,d.iH)(!1),i=(0,d.iH)([]);return(async()=>{try{t.value=!0;let o=await (0,y.LC)();(0,c.kJ)(o)&&(i.value=o.map(e=>({label:e.domain,value:e.domain})),e.isAll?(i.value.unshift({label:a("common.all.text"),value:""}),l.value||(l.value="")):o.length>0&&!l.value&&(l.value=o[0].domain))}finally{t.value=!1}})(),(e,o)=>{let n=S.Z;return(0,d.wg)(),(0,d.j4)(n,{value:l.value,"onUpdate:value":o[0]||(o[0]=e=>l.value=e),loading:(0,d.SU)(t),filterable:!0,options:(0,d.SU)(i),placeholder:(0,d.SU)(a)("mailbox.domain.selectPlaceholder")},null,8,["value","loading","options","placeholder"])}}}),k=(0,l(41748).default)(Z,[["__scopeId","data-v-186220da"]]);var M=l(46244),C=l(29283),A=l(6455),T=l(79537),q=l(73084);let O=(0,d.aZ)({__name:"MailboxForm",setup(e){let{t:a}=(0,W.QT)(),l=(0,d.iH)(!1),t=(0,d.Fl)(()=>l.value?a("mailbox.form.editTitle"):a("mailbox.form.addTitle")),i=(0,d.AE)("formRef"),o=(0,d.qj)({quota:5,unit:"GB",isAdmin:0,full_name:"",domain:null,password:v(),active:1}),n=[{label:"GB",value:"GB"},{label:"MB",value:"MB"}],s=[{label:a("mailbox.userType.general"),value:0},{label:a("mailbox.userType.admin"),value:1}],u={full_name:{trigger:"blur",validator:()=>""!==o.full_name.trim()&&!!o.domain||Error(a("mailbox.validation.emailRequired"))},password:{trigger:"blur",validator:()=>{if(l.value){if(o.password&&o.password.trim().length<8)return Error(a("mailbox.validation.passwordLength"));if(o.password&&!/^(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).*$/.test(o.password))return Error(a("mailbox.validation.passwordFormat"))}else{if(o.password.trim().length<8)return Error(a("mailbox.validation.passwordLength"));if(!/^(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).*$/.test(o.password))return Error(a("mailbox.validation.passwordFormat"))}return!0}}},m=(e,a)=>{switch(a){case"GB":e*=1024;case"MB":e*=1048576}return e},p=()=>({full_name:o.full_name,domain:o.domain||"",password:o.password,quota:m(o.quota,o.unit),isAdmin:o.isAdmin,active:o.active});function v(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:16;e=Math.max(e,3);let a="abcdefghijklmnopqrstuvwxyz",l="ABCDEFGHIJKLMNOPQRSTUVWXYZ",t="0123456789",i=a+l+t,o="";o+=a.charAt(Math.floor(Math.random()*a.length)),o+=l.charAt(Math.floor(Math.random()*l.length)),o+=t.charAt(Math.floor(Math.random()*t.length));for(let a=3;a<e;a++){let e=Math.floor(Math.random()*i.length);o+=i[e]}return o.split("").sort(()=>Math.random()-.5).join("")}let[g,w]=(0,f.d)({onChangeState:e=>{if(e){let e=w.getState(),{row:a}=e;if(l.value=e.isEdit,a){o.full_name=a.full_name,o.domain=a.domain,o.isAdmin=a.is_admin,o.active=a.active,o.password=a.password;let[e,l]=(0,c.UO)(a.quota).split(" ");o.quota=(0,c.Dx)(e),o.unit=l}}else o.full_name="",o.domain=null,o.password=v(),o.quota=5,o.unit="GB",o.isAdmin=0,o.active=1},onConfirm:async()=>{var e;await (null==(e=i.value)?void 0:e.validate());let a=p();l.value?await (0,h.EV)(a):await (0,h.Ts)(a),w.getState().refresh()}});return(e,m)=>{let p=q.Z,c=T.Z,f=A.ZP,v=C.Z,h=S.Z,w=r.Z,x=M.Z;return(0,d.wg)(),(0,d.j4)((0,d.SU)(g),{title:(0,d.SU)(t),width:"520"},{default:(0,d.w5)(()=>[(0,d.Wm)(x,{ref_key:"formRef",ref:i,class:"pt-20px",model:(0,d.SU)(o),rules:u},{default:(0,d.w5)(()=>[(0,d.Wm)(f,{label:(0,d.SU)(a)("mailbox.form.emailAddress"),path:"full_name"},{default:(0,d.w5)(()=>[(0,d.Wm)(c,null,{default:(0,d.w5)(()=>[(0,d.Wm)(p,{value:(0,d.SU)(o).full_name,"onUpdate:value":m[0]||(m[0]=e=>(0,d.SU)(o).full_name=e),class:"flex-1",disabled:(0,d.SU)(l)},null,8,["value","disabled"]),(0,d.Wm)(k,{value:(0,d.SU)(o).domain,"onUpdate:value":m[1]||(m[1]=e=>(0,d.SU)(o).domain=e),class:"flex-1","is-all":!1,disabled:(0,d.SU)(l)},null,8,["value","disabled"])]),_:1})]),_:1},8,["label"]),(0,d.Wm)(f,{label:(0,d.SU)(a)("mailbox.form.password"),path:"password"},{default:(0,d.w5)(()=>[(0,d.Wm)(p,{value:(0,d.SU)(o).password,"onUpdate:value":m[2]||(m[2]=e=>(0,d.SU)(o).password=e),placeholder:(0,d.SU)(a)("mailbox.form.passwordPlaceholder")},null,8,["value","placeholder"])]),_:1},8,["label"]),(0,d.Wm)(f,{label:(0,d.SU)(a)("mailbox.form.quota"),path:"quota"},{default:(0,d.w5)(()=>[(0,d.Wm)(c,null,{default:(0,d.w5)(()=>[(0,d.Wm)(v,{value:(0,d.SU)(o).quota,"onUpdate:value":m[3]||(m[3]=e=>(0,d.SU)(o).quota=e),class:"flex-1",min:1,"show-button":!1},null,8,["value"]),(0,d.Wm)(h,{value:(0,d.SU)(o).unit,"onUpdate:value":m[4]||(m[4]=e=>(0,d.SU)(o).unit=e),class:"flex-1",options:n},null,8,["value"])]),_:1})]),_:1},8,["label"]),(0,d.Wm)(f,{label:(0,d.SU)(a)("mailbox.form.userType"),path:"userType"},{default:(0,d.w5)(()=>[(0,d.Wm)(h,{value:(0,d.SU)(o).isAdmin,"onUpdate:value":m[5]||(m[5]=e=>(0,d.SU)(o).isAdmin=e),options:s},null,8,["value"])]),_:1},8,["label"]),(0,d.Wm)(f,{label:(0,d.SU)(a)("mailbox.form.status"),"show-feedback":!1},{default:(0,d.w5)(()=>[(0,d.Wm)(w,{value:(0,d.SU)(o).active,"onUpdate:value":m[6]||(m[6]=e=>(0,d.SU)(o).active=e),"checked-value":1,"unchecked-value":0},null,8,["value"])]),_:1},8,["label"])]),_:1},8,["model"])]),_:1},8,["title"])}}}),E={class:"p-24px"},z={class:"bt-title"},P={class:"w-220px"};function j(e){return"function"==typeof e||"[object Object]"===Object.prototype.toString.call(e)&&!(0,d.lA)(e)}let V=(0,d.aZ)({__name:"index",setup(e){let a=(0,p.tLD)(),{t:l}=(0,W.QT)(),{copyText:w}=(0,v.F)(),{tableParams:x,tableList:b,loading:_,tableTotal:S,getTableData:y}=(0,g.Z)({loading:!0,immediate:!0,params:{page:1,page_size:10,domain:a.value.state.domain||"",keyword:""},fetchFn:h.iC}),Z=(0,d.iH)([{key:"username",title:l("mailbox.columns.username"),minWidth:120,ellipsis:{tooltip:!0}},{key:"password",title:l("mailbox.columns.password"),width:"18%",minWidth:120,render:e=>(0,d.Wm)(U,{value:e.password||"--"},null)},{key:"login",title:l("mailbox.columns.loginInfo"),render:e=>{let a;return(0,d.Wm)(u.ZP,{text:!0,type:"primary",onClick:()=>{w(l("mailbox.loginInfo.template",{webmail:window.location.origin+"/roundcube",username:e.username,password:e.password,mx:e.mx}))}},j(a=l("common.actions.copy"))?a:{default:()=>[a]})}},{key:"quota",title:l("mailbox.columns.quota"),width:"14%",minWidth:120,render:e=>(0,c.UO)(e.quota)},{key:"is_admin",title:l("mailbox.columns.type"),width:"14%",minWidth:100,render:e=>1===e.is_admin?l("mailbox.userType.admin"):l("mailbox.userType.general")},{key:"status",title:l("mailbox.columns.status"),width:"12%",minWidth:80,render:e=>(0,d.Wm)(r.Z,{value:e.active,"checked-value":1,"unchecked-value":0,size:"small",onUpdateValue:a=>{T(e,a)}},null)},{title:l("common.columns.actions"),key:"actions",align:"right",width:120,render:e=>{let a,t;return(0,d.Wm)(m.Z,{inline:!0},{default:()=>[(0,d.Wm)(u.ZP,{type:"primary",text:!0,onClick:()=>{q(e)}},j(a=l("common.actions.edit"))?a:{default:()=>[a]}),(0,d.Wm)(u.ZP,{type:"error",text:!0,onClick:()=>{V(e)}},j(t=l("common.actions.delete"))?t:{default:()=>[t]})]})}}]),[M,C]=(0,f.d)({component:O,state:{isEdit:!1,refresh:y}}),A=()=>{C.setState({isEdit:!1,row:null}),C.open()},T=async(e,a)=>{await (0,h.EV)({full_name:e.full_name,domain:e.domain,password:e.password,quota:e.quota,isAdmin:e.is_admin,active:a}),e.active=a},q=e=>{C.setState({isEdit:!0,row:e}),C.open()},V=e=>{(0,c.iG)({title:l("mailbox.delete.title"),content:l("mailbox.delete.confirm",{name:e.username}),confirmText:l("common.actions.delete"),confirmType:"error",onConfirm:async()=>{await (0,h.WS)({email:e.username}),y()}})};return(e,a)=>{let r=s.Z,m=n.Z,p=o.Z,c=i.Z,f=t.Z;return(0,d.wg)(),(0,d.iD)("div",E,[(0,d._)("div",z,(0,d.zw)((0,d.SU)(l)("layout.menu.mailboxes")),1),(0,d.Wm)(f,null,{toolsLeft:(0,d.w5)(()=>[(0,d.Wm)((0,d.SU)(u.ZP),{type:"primary",onClick:A},{default:(0,d.w5)(()=>[(0,d.Uk)((0,d.zw)((0,d.SU)(l)("mailbox.actions.add")),1)]),_:1})]),toolsRight:(0,d.w5)(()=>[(0,d._)("div",P,[(0,d.Wm)(k,{value:(0,d.SU)(x).domain,"onUpdate:value":[a[0]||(a[0]=e=>(0,d.SU)(x).domain=e),a[1]||(a[1]=()=>(0,d.SU)(y)(!0))]},null,8,["value"])]),(0,d.Wm)(r,{value:(0,d.SU)(x).keyword,"onUpdate:value":a[2]||(a[2]=e=>(0,d.SU)(x).keyword=e),width:"280",placeholder:(0,d.SU)(l)("mailbox.search.usernamePlaceholder"),onSearch:a[3]||(a[3]=()=>(0,d.SU)(y)(!0))},null,8,["value","placeholder"])]),table:(0,d.w5)(()=>[(0,d.Wm)(p,{loading:(0,d.SU)(_),columns:(0,d.SU)(Z),data:(0,d.SU)(b)},{empty:(0,d.w5)(()=>[(0,d.Wm)(m)]),_:1},8,["loading","columns","data"])]),pageRight:(0,d.w5)(()=>[(0,d.Wm)(c,{page:(0,d.SU)(x).page,"onUpdate:page":a[4]||(a[4]=e=>(0,d.SU)(x).page=e),"page-size":(0,d.SU)(x).page_size,"onUpdate:pageSize":a[5]||(a[5]=e=>(0,d.SU)(x).page_size=e),"item-count":(0,d.SU)(S),onRefresh:(0,d.SU)(y)},null,8,["page","page-size","item-count","onRefresh"])]),modal:(0,d.w5)(()=>[(0,d.Wm)((0,d.SU)(M))]),_:1})])}}})}}]);